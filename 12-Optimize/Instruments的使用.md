#Instruments

##Time Profiler

Time Profiler用来检测CPU的使用情况。它可以告诉我们程序中的哪个方法正在消耗大量的CPU时间。使用大量的CPU并不一定是个问题-你可能期望动画路径对CPU非常依赖，因为动画往往是iOS设备中最苛刻的任务。  
但是如果你有性能问题，查看CPU时间对于判断性能是不是和CPU相关，以及定位到函数都很有帮助。

Time Profilter有一些选项来帮助我们定位到我们关心的方法。可以使用左侧的复选框来打开。其中最有用的是如下几点：
  - 通过线程分离-这可以通过执行的线程进行分组。如果代码被多线程分离的话，那么久可以判断到底是哪个线程造成了问题。
  - 隐藏系统库-可以隐藏所有苹果的框架代码，来帮助我们寻找哪一段代码造成了性能瓶颈。由于我们不能优化系统框架，所以这对定位到我们能实际修复的代码很有用。
  - 只显示Obj-C代码-隐藏了除OC之外的所有代码。大多数内部的Core Animation代码都是用C或者C++函数，所以这对我们集中精力到我们代码中显式调用的方法就很有用。

##Core Animation

Core Animation工具用来监测Core Animation性能。它给我们提供了周期性的FPS，并且考虑到了发生在程序之外的动画。  
Core Animation工具也提供了一系列复选框来帮助调试渲染瓶颈：
  - Color Blended Layers-这个选项基于渲染程度对屏幕中的混合区域进行绿到红的高亮（也就是多半个透明图层的叠加）。由于重绘的原因，混合对GPU性能会影响，同是也是滑动或动画帧率下降的罪魁祸首之一。
  - ColorHitsGreenandMissesRed-当使用shouldRasterizep属性的时候，耗时的图层绘制会被缓存，然后当做一个简单的扁平图片呈现。当缓存再生的时候这个选项就用红色对栅格化图层进行了高亮。如果缓存频繁再生的话，就意味着栅格化可能会有负面的性能影响了。
  - Color Copied Images-有时候寄宿图片的生成意味着Core Animation被强制生成一些图片，然后发送到渲染服务器，而不是简单的指向原始指针。这个选项把这些图片渲染成蓝色。复制图片对内存和CPU使用来说都是一项非常昂贵的操作，所以应该尽可能的避免。
